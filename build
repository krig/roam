#!/bin/bash

configure() {
	if ! which cmake >/dev/null; then
        echo "CMAKE not found."
        exit 1
	fi
	mkdir -p obj
	cd obj
	if which ninja >/dev/null; then
		cmake -G Ninja ..
	else
		cmake ..
	fi
	cd ..
}

if [ "$1x" == "cleanx" ]; then
    rm -rf obj
	exit $?
fi

[[ ! -d obj ]] && configure
cd obj
if which ninja >/dev/null; then
	ninja "$@"
else
    make "$@"
fi
cd ..
cp obj/roam ./roam
